<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Kanban Board Viewer</title>
    <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<div class="header">
    <h1 id="project-title">Loading...</h1>
    <div class="project-meta">
        <span id="project-type"></span>
        <span class="project-meta-separator"></span>
        <span class="project-created" id="project-created"></span>
    </div>
    <div class="stats-container">
        <div class="stats-section">
            <div class="stats-title">Task Statistics</div>
            <div class="stats">
                <div class="stat stat-pending">
                    <div class="stat-value" id="stat-pending">0</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat stat-blocked">
                    <div class="stat-value" id="stat-blocked">0</div>
                    <div class="stat-label">Hold</div>
                </div>
                <div class="stat stat-progress">
                    <div class="stat-value" id="stat-progress">0</div>
                    <div class="stat-label">In Progress</div>
                </div>
                <div class="stat stat-review">
                    <div class="stat-value" id="stat-review">0</div>
                    <div class="stat-label">Code Review</div>
                </div>
                <div class="stat stat-completed">
                    <div class="stat-value" id="stat-completed">0</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>
        </div>
        <div class="stats-separator"></div>
        <div class="stats-section">
            <div class="stats-title">Token Statistics</div>
            <div class="stats">
                <div class="stat stat-min">
                    <div class="stat-value" id="stat-min">0</div>
                    <div class="stat-label">Minimum</div>
                </div>
                <div class="stat stat-max">
                    <div class="stat-value" id="stat-max">0</div>
                    <div class="stat-label">Maximum</div>
                </div>
                <div class="stat stat-avg">
                    <div class="stat-value" id="stat-avg">0</div>
                    <div class="stat-label">Average</div>
                </div>
                <div class="stat stat-tokens">
                    <div class="stat-value" id="stat-tokens">0</div>
                    <div class="stat-label">Total</div>
                </div>
            </div>
        </div>
    </div>
    <div class="progress-bar">
        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
    </div>
</div>

<div class="board">
    <div
            class="column column-pending"
            data-column="pending"
            onclick="handleColumnClick(event, this)"
    >
        <div class="column-header">
            <span class="column-title">Pending</span>
            <span class="column-count" id="count-pending">0</span>
            <div class="column-controls">
                <button
                        class="control-btn minimize-btn"
                        title="Minimize"
                        onclick="toggleMinimize(event, 'pending')"
                >
                    <svg viewBox="0 0 24 24">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <button
                        class="control-btn maximize-btn"
                        title="Maximize"
                        onclick="toggleMaximize(event, 'pending')"
                >
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="tasks" id="tasks-pending"></div>
    </div>

    <div
            class="column column-blocked"
            data-column="blocked"
            onclick="handleColumnClick(event, this)"
    >
        <div class="column-header">
            <span class="column-title">Hold</span>
            <span class="column-count" id="count-blocked">0</span>
            <div class="column-controls">
                <button
                        class="control-btn minimize-btn"
                        title="Minimize"
                        onclick="toggleMinimize(event, 'blocked')"
                >
                    <svg viewBox="0 0 24 24">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <button
                        class="control-btn maximize-btn"
                        title="Maximize"
                        onclick="toggleMaximize(event, 'blocked')"
                >
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="tasks" id="tasks-blocked"></div>
    </div>

    <div
            class="column column-progress"
            data-column="progress"
            onclick="handleColumnClick(event, this)"
    >
        <div class="column-header">
            <span class="column-title">In Progress</span>
            <span class="column-count" id="count-progress">0</span>
            <div class="column-controls">
                <button
                        class="control-btn minimize-btn"
                        title="Minimize"
                        onclick="toggleMinimize(event, 'progress')"
                >
                    <svg viewBox="0 0 24 24">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <button
                        class="control-btn maximize-btn"
                        title="Maximize"
                        onclick="toggleMaximize(event, 'progress')"
                >
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="tasks" id="tasks-progress"></div>
    </div>

    <div
            class="column column-review"
            data-column="review"
            onclick="handleColumnClick(event, this)"
    >
        <div class="column-header">
            <span class="column-title">Code Review</span>
            <span class="column-count" id="count-review">0</span>
            <div class="column-controls">
                <button
                        class="control-btn minimize-btn"
                        title="Minimize"
                        onclick="toggleMinimize(event, 'review')"
                >
                    <svg viewBox="0 0 24 24">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <button
                        class="control-btn maximize-btn"
                        title="Maximize"
                        onclick="toggleMaximize(event, 'review')"
                >
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="tasks" id="tasks-review"></div>
    </div>

    <div
            class="column column-completed"
            data-column="completed"
            onclick="handleColumnClick(event, this)"
    >
        <div class="column-header">
            <span class="column-title">Completed</span>
            <span class="column-count" id="count-completed">0</span>
            <div class="column-controls">
                <button
                        class="control-btn minimize-btn"
                        title="Minimize"
                        onclick="toggleMinimize(event, 'completed')"
                >
                    <svg viewBox="0 0 24 24">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <button
                        class="control-btn maximize-btn"
                        title="Maximize"
                        onclick="toggleMaximize(event, 'completed')"
                >
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="tasks" id="tasks-completed"></div>
    </div>
</div>

<div class="refresh-indicator">
    <span>Status:</span>
    <div class="status-circle" id="status-circle"></div>
</div>

<!-- Task Context Menu -->
<div id="task-context-menu" class="context-menu hidden">
    <div class="context-menu-item" data-action="show-details">
        <span class="context-menu-icon">üìã</span>
        Show task details
    </div>
    <div class="context-menu-item" data-action="view-metadata">
        <span class="context-menu-icon">üîç</span>
        View metadata
    </div>
</div>

<!-- Board Context Menu -->
<div id="board-context-menu" class="context-menu hidden">
    <div class="context-menu-item" data-action="refresh">
        <span class="context-menu-icon">üîÑ</span>
        Refresh board
    </div>
    <div class="context-menu-item" data-action="collapse-all">
        <span class="context-menu-icon">üìÅ</span>
        Collapse all tasks
    </div>
    <div class="context-menu-item" data-action="expand-all">
        <span class="context-menu-icon">üìÇ</span>
        Expand all tasks
    </div>
</div>

<!-- Metadata Modal -->
<div id="metadata-modal-overlay" class="modal-overlay hidden">
    <div id="metadata-modal" class="modal-container">
        <div class="modal-header">
            <span class="modal-title">Metadata</span>
            <div class="metadata-search-container">
                <input type="text" id="metadata-search" placeholder="Search..." />
                <span id="metadata-search-count"></span>
            </div>
            <button class="modal-close" title="Close">
                <svg viewBox="0 0 24 24" width="16" height="16">
                    <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                    <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>
        <div class="modal-tabs">
            <button class="modal-tab active" data-tab="board">board</button>
            <button class="modal-tab" data-tab="progress">progress</button>
            <button class="modal-tab" data-tab="log">worker-raw</button>
            <button class="modal-tab" data-tab="output">worker-output</button>
        </div>
        <div class="modal-content">
            <div class="modal-loading">Loading...</div>
        </div>
        <!-- Resize handles -->
        <div class="resize-handle resize-n"></div>
        <div class="resize-handle resize-s"></div>
        <div class="resize-handle resize-e"></div>
        <div class="resize-handle resize-w"></div>
        <div class="resize-handle resize-ne"></div>
        <div class="resize-handle resize-nw"></div>
        <div class="resize-handle resize-se"></div>
        <div class="resize-handle resize-sw"></div>
    </div>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>
